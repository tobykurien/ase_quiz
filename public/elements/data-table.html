<link rel="import"
      href="../bower_components/polymer/polymer.html">

<polymer-element name="data-table" attributes="model cols">
  <template>
      <button>Add new {{model}}</button>
      <p/>
      <table class="table table-hover">
         <tr>
            <template repeat="{{c in columns()}}">
            <td>{{c}}</td>
            </template>
            <td>Action</td>
         </tr>

         <template repeat="{{m in models}}">
         <tr>
            <template repeat="{{c in columns()}}">
            <td>{{m[c]}}</td>
            </template>
            <td>
               <button onClick="edit({{m.id}})">Edit</button> 
               <button onClick="del({{m.id}})">Del</button>
            </td>
         </tr>
         </template>
      </table>  
  </template>
  
  <script>
      var scope = null;
      
       Polymer({
         model: '',
         
         models: [],
         cols: "name",
         columns: function() {
            return this.cols.split(" ");
         },
         
         ready: function() {
            scope = this;
            
            if (this.model == '') {
               alert('Model not defined for data-table');
               return;
            }

            // load data
            var request = $.ajax({
               url: "/api/v1/" + this.model,
               type: "GET",
               //data: { id : menuId },
               dataType: "json"
            });
         
            request.done(function( msg ) {
               scope.models = msg;
            });
         
            request.fail(function( jqXHR, textStatus ) {
               alert( "Request failed: " + textStatus );
            });            
         }
       });
   
 
      function edit(id) {
         alert(scope.innerHTML);
      }

      function del(id) {
         alert(scope.innerHTML);
      }
   </script>
</polymer-element>
